sample(matricola + sample(123456789,size = length(matricola)), size = 8, replace = T)
sample(matricola + sample(123456789,size = length(matricola)), size = 8, replace = T)
matricola
sample(123456789,size = length(matricola))
matricola + sample(123456789,size = length(matricola))
matricola + sample(123456789,size = length(matricola))
matricola + sample(123456789,size = length(matricola))
matricola + sample(123456789,size = length(matricola))
matricola + sample(123456789,size = length(matricola))
matricola + sample(123456789,size = length(matricola))
matricola + sample(123456789,size = length(matricola))
matricola + sample(123456789,size = length(matricola))
matricola + sample(123456789,size = length(matricola))
matricola + sample(123456789,size = length(matricola))
matricola <- 800603
sample(matricola + sample(123456789,size = length(matricola)), size = 8, replace = T)
sample(matricola + sample(123456789,size = length(matricola)), size = 8, replace = T)
matricola + sample(123456789,size = length(matricola))
length(matricola)
length(matricola)
matricola <- as.numeric(strsplit(as.character(matricola),"")[[1]])
sample(123456789,size = length(matricola))
sample(123456789,size = length(matricola))
sample(123456789,size = length(matricola))
matricola <- as.numeric(strsplit(as.character(matricola),"")[[1]])
addterm <- as.numeric(strsplit(as.character(123456789),"")[[1]])
matricola <- 800603
matricola <- as.numeric(strsplit(as.character(matricola),"")[[1]])
addterm <- as.numeric(strsplit(as.character(123456789),"")[[1]])
sample(addterm,size = length(matricola))
matricola
matricola + sample(addterm,size = length(matricola))
paste0(matricola + sample(addterm,size = length(matricola)))
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
# matricola <- matricola[matricola!=0]
seed <- as.numeric(paste0(matricola + sample(addterm,size = length(matricola)),collapse = ""))
QuestionsExtractor <- function(matricola) {
matricola <- as.numeric(strsplit(as.character(matricola),"")[[1]])
addterm <- as.numeric(strsplit(as.character(123456789),"")[[1]])
# matricola <- matricola[matricola!=0]
seed <- as.numeric(paste0(matricola + sample(addterm,size = length(matricola)),collapse = ""))
# seed <- as.numeric(c(paste0(sample(matricola*1, size = 6, replace = T),
#                             sample(matricola*2, size = 6, replace = T),
#                             collapse = "")))
set.seed(seed)
sample(x = 1:15, size = 2, replace = F)
}
matricola <- 800603
n_reps <- 50000
for (r in 1:n_reps) {
if (r==1) {
vec <- QuestionsExtractor(matricola = matricola)
}
vec <- c(vec,QuestionsExtractor(matricola = matricola))
}
table(vec)
hist(vec)
matricola <- 800603
n_reps <- 50000
for (r in 1:n_reps) {
if (r==1) {
vec <- QuestionsExtractor(matricola = matricola)
}
vec <- c(vec,QuestionsExtractor(matricola = matricola))
}
table(vec)
hist(vec)
addterm
matricola <- as.numeric(strsplit(as.character(matricola),"")[[1]])
addterm <- as.numeric(strsplit(as.character(123456789),"")[[1]])
paste0(matricola + sample(addterm,size = length(matricola))
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
paste0(matricola + sample(addterm,size = length(matricola)),collapse = "")
addterm
matricola + sample(addterm,size = length(matricola))
matricola + sample(addterm,size = length(matricola))
matricola + sample(addterm,size = length(matricola))
matricola + sample(addterm,size = length(matricola))
matricola + sample(addterm,size = length(matricola))
as.numeric(paste0(matricola + sample(addterm,size = length(matricola),replace = F),collapse = ""))
as.numeric(paste0(matricola + sample(addterm,size = length(matricola),replace = F),collapse = ""))
as.numeric(paste0(matricola + sample(addterm,size = length(matricola),replace = F),collapse = ""))
as.numeric(paste0(matricola + sample(addterm,size = length(matricola),replace = F),collapse = ""))
as.numeric(paste0(matricola + sample(addterm,size = length(matricola),replace = F),collapse = ""))
as.numeric(paste0(matricola + sample(addterm,size = length(matricola),replace = F),collapse = ""))
as.numeric(paste0(matricola + sample(addterm,size = length(matricola),replace = F),collapse = ""))
as.numeric(paste0(matricola + sample(addterm,size = length(matricola),replace = F),collapse = ""))
as.numeric(paste0(matricola + sample(addterm,size = length(matricola),replace = F),collapse = ""))
as.numeric(paste0(matricola + sample(addterm,size = length(matricola),replace = F),collapse = ""))
as.numeric(paste0(matricola + sample(addterm,size = length(matricola),replace = F),collapse = ""))
as.numeric(paste0(matricola + sample(addterm,size = length(matricola),replace = F),collapse = ""))
as.numeric(paste0(matricola + sample(addterm,size = length(matricola),replace = F),collapse = ""))
as.numeric(paste0(matricola + sample(addterm,size = length(matricola),replace = F),collapse = ""))
as.numeric(paste0(matricola + sample(addterm,size = length(matricola),replace = F),collapse = ""))
as.numeric(paste0(matricola + sample(addterm,size = length(matricola),replace = F),collapse = ""))
as.numeric(paste0(matricola + sample(addterm,size = length(matricola),replace = F),collapse = ""))
as.numeric(paste0(matricola + sample(addterm,size = length(matricola),replace = F),collapse = ""))
as.numeric(paste0(matricola + sample(addterm,size = length(matricola),replace = F),collapse = ""))
as.numeric(paste0(matricola + sample(addterm,size = length(matricola),replace = F),collapse = ""))
as.numeric(paste0(matricola + sample(addterm,size = length(matricola),replace = F),collapse = ""))
as.numeric(paste0(matricola + sample(addterm,size = length(matricola),replace = F),collapse = ""))
as.numeric(paste0(matricola + sample(addterm,size = length(matricola),replace = F),collapse = ""))
QuestionsExtractor <- function(matricola) {
matricola <- as.numeric(strsplit(as.character(matricola),"")[[1]])
addterm <- as.numeric(strsplit(as.character(123456789),"")[[1]])
# matricola <- matricola[matricola!=0]
seed <- as.numeric(paste0(matricola + sample(addterm,size = length(matricola),replace = F),collapse = ""))
# seed <- as.numeric(c(paste0(sample(matricola*1, size = 6, replace = T),
#                             sample(matricola*2, size = 6, replace = T),
#                             collapse = "")))
set.seed(seed)
sample(x = 1:15, size = 2, replace = F)
}
matricola <- 800603
n_reps <- 50000
for (r in 1:n_reps) {
if (r==1) {
vec <- QuestionsExtractor(matricola = matricola)
}
vec <- c(vec,QuestionsExtractor(matricola = matricola))
}
hist(vec)
table(vec)
hist(vec)
table(vec)
plot(table(vec))
matricola <- 800603
n_reps <- 50000
for (r in 1:n_reps) {
if (r==1) {
vec <- QuestionsExtractor(matricola = matricola)
}
vec <- c(vec,QuestionsExtractor(matricola = matricola))
}
plot(table(vec))
library(haven)
spese97_12 <- read_dta("J:/Il mio Drive/Consumption_Torino/data/spese97_12.dta")
View(spese97_12)
View(spese97_12)
View(spese97_12)
View(spese97_12)
View(spese97_12)
View(spese97_12)
colnames(spese97_12)
library(haven)
spese97_12 <- read_dta("J:/Il mio Drive/Consumption_Torino/data/spese97_12.dta")
View(spese97_12)
3648/19
192/12
View(spese97_12)
library(mgcv)
library(tidyverse)
library(stringi)
spese97_12 %>%
mutate(Anno = str_sub(AnnoMesReg, start = 1, end = 4))
spese97_12 %>%
mutate(Anno = str_sub(AnnoMesReg, start = 1, end = 4)) %>%
View()
str_sub(AnnoMesReg, start = 1, end = 4)
str_sub(spese97_12$AnnoMesReg, start = 1, end = 4)
spese97_12 %>%
mutate(Anno = as.numeric(str_sub(AnnoMesReg, start = 1, end = 4)),
Mese = as.numeric(str_sub(AnnoMesReg, start = 5, end = 6)),
Regione = as.numeric(str_sub(AnnoMesReg, start = 7, end = 8))) %>%
View()
spese97_12 %>%
mutate(Year = as.numeric(str_sub(AnnoMesReg, start = 1, end = 4)),
Month = as.numeric(str_sub(AnnoMesReg, start = 5, end = 6)),
Region = as.numeric(str_sub(AnnoMesReg, start = 7, end = 8))) %>%
View()
spese97_12 %>%
select(Year = Anno, Month = mese, Region = regione,Wc_3101,Wc_3102) %>%
View()
Data <- spese97_12 %>%
select(Year = Anno, Month = mese, Region = regione,Wc_3101,Wc_3102)
View(Data)
Data <- spese97_12 %>%
select(Year = Anno, Month = mese, Region = regione,Wc_3101,Wc_3102,Feb06)
View(Data)
Data <- spese97_12 %>%
select(Year = Anno, Month = mese, Region = regione,Wc_3101,Wc_3102,Feb06) %>%
pivot_longer(cols = contains("Wc"), names_to = "GoodService", values_to = "Qty")
View(Data)
Data_reg <- Data %>%
filter(Region == 1)
384/2
nlme::lme(fixed = Ec_3101 ~ Feb06,
data = Data_reg,
random = ~ 1 | GoodService,
#correlation = AR1(form = ~ longitude + latitude | dummy),
method = "ML",
control=nlme::lmeControl(sing.tol=1e-20))
nlme::lme(fixed = Qty ~ Feb06,
data = Data_reg,
random = ~ 1 | GoodService,
#correlation = AR1(form = ~ longitude + latitude | dummy),
method = "ML",
control=nlme::lmeControl(sing.tol=1e-20))
Data <- spese97_12 %>%
select(Year = Anno, Month = mese, Region = regione,Feb06,contains("Wc_")) %>%
pivot_longer(cols = contains("Wc"), names_to = "GoodService", values_to = "Qty")
Data_reg <- Data %>%
filter(Region == 1)
View(Data)
nlme::lme(fixed = Qty ~ Feb06,
data = Data_reg,
random = ~ 1 | GoodService,
#correlation = AR1(form = ~ longitude + latitude | dummy),
method = "ML",
control=nlme::lmeControl(sing.tol=1e-20))
summary(Data)
View(Data)
1014144/192
1014144/(192*19)
length(2:288)
19*192*287
19*192*278
summary(Data_reg)
is.na(Data_reg$Qty)
Data_reg[is.na(Data_reg$Qty),
]
Data_reg[is.na(Data_reg$Qty),] %>% View()
Data_reg[is.na(Data_reg$Qty),] %>% View()
Data_reg <- Data %>%
filter(Region == 1, Year >= 2003)
Data_reg[is.na(Data_reg$Qty),] %>% View()
nlme::lme(fixed = Qty ~ Feb06,
data = Data_reg,
random = ~ 1 | GoodService,
#correlation = AR1(form = ~ longitude + latitude | dummy),
method = "ML",
control=nlme::lmeControl(sing.tol=1e-20))
mgcv::gamm(formula = Qty ~ Feb06,
#correlation = corExp(nugget = TRUE, form = ~ Latitude + Longitude | Year),
family = Gaussian(),
method = "ML",
niterPQL = 100,
data = Data_red)
mgcv::gamm(formula = Qty ~ Feb06,
#correlation = corExp(nugget = TRUE, form = ~ Latitude + Longitude | Year),
# family = Gaussian(),
method = "ML",
niterPQL = 100,
data = Data_red)
mgcv::gamm(formula = Qty ~ Feb06,
#correlation = corExp(nugget = TRUE, form = ~ Latitude + Longitude | Year),
# family = Gaussian(),
method = "ML",
niterPQL = 100,
data = Data_reg)
mgcv::gamm(formula = Qty ~ Feb06 + s(Month),
random = list(GoodService = ~ 1),
#correlation = corExp(nugget = TRUE, form = ~ Latitude + Longitude | Year),
# family = Gaussian(),
method = "ML",
niterPQL = 100,
data = Data_reg)
library(eurostat)
library(tidyverse)
library(ggplot2)
library(ggpubr)
##### Employed by sex, age and educational attainment
data1 <- get_eurostat(id = "lfst_r_lfe2eedu")
table(data1$time)
library(lubridate)
data1 %>%
mutate(Year = year(time))
table(data1$unit)
table(data1$sex)
table(data1$age)
##### Settings
Contry_code <- c("IT","FR","DE","SP")
Contries <- c("Italy","France","Germany","Spain")
##### Settings
Contry_code <- c("IT","FR","DE","SP")
data1 %>%
mutate(Year = year(time)) %>%
rename(Sex = sex) %>%
filter(time >= "1",
Sex != "T",
age == "Y15-64",
geo %in% Country_code)
data1 %>%
mutate(Year = year(time)) %>%
rename(Sex = sex) %>%
filter(Year >= 2000,
Sex != "T",
age == "Y15-64",
geo %in% Country_code)
##### Settings
Country_code <- c("IT","FR","DE","SP")
Contries <- c("Italy","France","Germany","Spain")
data1 %>%
mutate(Year = year(time)) %>%
rename(Sex = sex) %>%
filter(Sex != "T",
age == "Y15-64",
geo %in% Country_code)
table(data1$geo) %>% View()
##### Settings
Country_code <- c("IT","FR","DE","ES")
data1 %>%
mutate(Year = year(time)) %>%
rename(Sex = sex) %>%
filter(Sex != "T",
age == "Y15-64",
geo %in% Country_code)
table(data1$isced11)
data1 %>%
mutate(Year = year(time),
EduLevel = case_when(isced11 == "ED0-2" ~ "Edu_0_2",
isced11 == "ED3_4" ~ "Edu_3_4",
isced11 == "ED5-8" ~ "Edu_5_8",
isced11 == "Total" ~ "Total",
TRUE ~ isced11)) %>%
rename(Sex = sex) %>%
filter(Sex != "T",
age == "Y15-64",
geo %in% Country_code,
EduLevel != "NRP") %>%
select(-c(unit,age,isced11))
data1 %>%
mutate(Year = year(time),
EduLevel = case_when(isced11 == "ED0-2" ~ "Edu_0_2",
isced11 == "ED3_4" ~ "Edu_3_4",
isced11 == "ED5-8" ~ "Edu_5_8",
isced11 == "Total" ~ "Total",
TRUE ~ isced11)) %>%
rename(Sex = sex) %>%
filter(Sex != "T",
age == "Y15-64",
geo %in% Country_code,
EduLevel != "NRP") %>%
select(-c(unit,age,isced11,time))
736/4
736/(4*4)
736/(4*4*2)
data1 <- data1 %>%
mutate(Year = year(time),
EduLevel = case_when(isced11 == "ED0-2" ~ "Edu_0_2",
isced11 == "ED3_4" ~ "Edu_3_4",
isced11 == "ED5-8" ~ "Edu_5_8",
isced11 == "Total" ~ "Total",
TRUE ~ isced11)) %>%
rename(Sex = sex) %>%
filter(Sex != "T",
age == "Y15-64",
geo %in% Country_code,
EduLevel != "NRP") %>%
select(-c(unit,age,isced11,time))
data1 %>%
group_by(geo,Year) %>%
mutate(Tot = sum(values))
'%notin%' <- Negate('%in%')
##### Employed by sex, age and educational attainment
data1 <- get_eurostat(id = "lfst_r_lfe2eedu")
data1 <- data1 %>%
mutate(Year = year(time),
EduLevel = case_when(isced11 == "ED0-2" ~ "Edu_0_2",
isced11 == "ED3_4" ~ "Edu_3_4",
isced11 == "ED5-8" ~ "Edu_5_8",
# isced11 == "Total" ~ "Total",
TRUE ~ isced11)) %>%
rename(Sex = sex) %>%
filter(Sex != "T",
age == "Y15-64",
geo %in% Country_code,
EduLevel %notin% c("NRP","TOTAL")) %>%
select(-c(unit,age,isced11,time))
View(data1)
data1 %>%
group_by(geo,Year) %>%
mutate(Tot = sum(values))
data1 %>%
group_by(geo,Year) %>%
mutate(Tot = sum(values)) %>%
ungroup()
data1 %>%
group_by(geo,Year) %>%
mutate(Tot = sum(values)) %>%
ungroup() %>%
group_by(geo,Year,EduLevel) %>%
mutate(Comp_EduLevel = values/Tot*100)
data1 <- data1 %>%
group_by(geo,Year) %>%
mutate(Tot = sum(values)) %>%
ungroup() %>%
group_by(geo,Year,EduLevel) %>%
mutate(Comp_EduLevel = values/Tot*100)
data1 %>%
ggplot(aes(y=Comp_EduLevel, x = Year, fill = Sex))
data1 %>%
ggplot(aes(y=Comp_EduLevel, x = Year, fill = Sex)) +
geom_bar(position="fill", stat="identity") +
facet_wrap(~ geo, ncol = 4) +
labs(title = "Time 1")
data1 %>%
ggplot(aes(y=Comp_EduLevel, x = Year, fill = EduLevel)) +
geom_bar(position="fill", stat="identity") +
facet_wrap(~ geo, ncol = 4) +
labs(title = "Time 1")
data1 %>%
ggplot(aes(y=Comp_EduLevel, x = Year, fill = EduLevel)) +
geom_bar(position="fill", stat="identity") +
facet_grid(rows = geo,cols = Sex, ncol = 2) +
labs(title = "Time 1")
data1 %>%
ggplot(aes(y=Comp_EduLevel, x = Year, fill = EduLevel)) +
geom_bar(position="fill", stat="identity") +
facet_grid(rows = geo,cols = Sex) +
labs(title = "Time 1")
data1 %>%
ggplot(aes(y=Comp_EduLevel, x = Year, fill = EduLevel)) +
geom_bar(position="fill", stat="identity") +
facet_grid(rows = "geo", cols = "Sex") +
labs(title = "Time 1")
data1 %>%
ggplot(aes(y=Comp_EduLevel, x = Year, fill = EduLevel)) +
geom_bar(position="fill", stat="identity") +
facet_grid(rows = "geo", cols = "Sex")
data1 %>%
ggplot(aes(y=Comp_EduLevel, x = Year, fill = EduLevel)) +
geom_bar(position="fill", stat="identity")
data1 %>%
ggplot(aes(y=Comp_EduLevel, x = Year, fill = EduLevel)) +
geom_bar(position="fill", stat="identity") +
facet_wrap(~ geo, ncol = 4) +
labs(title = "Time 1")
data1 %>%
ggplot(aes(y=Comp_EduLevel, x = Year, fill = EduLevel)) +
geom_bar(position="fill", stat="identity") +
facet_wrap(~ geo + Sex, ncol = 4) +
labs(title = "Time 1")
data1 %>%
ggplot(aes(y=Comp_EduLevel, x = Year, fill = EduLevel)) +
geom_bar(position="fill", stat="identity") +
facet_wrap(~ geo + Sex, ncol = 2) +
labs(title = "Time 1")
data1 %>%
ggplot(aes(y=Comp_EduLevel, x = Year, fill = EduLevel)) +
geom_bar(position="fill", stat="identity") +
facet_wrap(~ Sex + geo, ncol = 4) +
labs(title = "Time 1")
exp(2)
##### Working directory
setwd("H:/.shortcut-targets-by-id/1hRMzSqAcE5AcmrsOu5k3nw1rmUY1NHyO/QA&COVID19/VisitingLUH2021/Code/funHDGM_sim/VarDecomposition")
##### Packages
library(tidyverse)
library(ggplot2)
library(ggpubr)
library(readxl)
##### Load simulations
Sims_G <- read_excel("Sims_G.xlsx")
Sims_Vz <- read_excel("Sims_Vz.xlsx")
Sims_Theta <- read_excel("Sims_Theta.xlsx")
View(Sims_Theta)
